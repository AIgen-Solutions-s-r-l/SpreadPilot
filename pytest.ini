[pytest]
testpaths = tests
python_files = test_*.py
python_classes = Test*
python_functions = test_*
pythonpath = . # Add project root to allow finding modules like report-worker

# Mark tests that require external services
markers =
    integration: marks tests as integration tests (requires service dependencies)
    slow: marks tests as slow (may take longer to run)
    external: marks tests that require external services
    e2e: marks tests as end-to-end tests (requires full system setup)

# Configure asyncio
asyncio_mode = auto
asyncio_default_fixture_loop_scope = function

# Configure logging
log_cli = true
log_cli_level = INFO
log_cli_format = %(asctime)s [%(levelname)8s] %(message)s (%(filename)s:%(lineno)s)
log_cli_date_format = %Y-%m-%d %H:%M:%S

# Environment variables for testing
env =
    MONGO_URI=mongodb://test:test@localhost:27017
    MONGO_DB_NAME=spreadpilot_test
    JWT_SECRET=test-secret
    ADMIN_USERNAME=admin
    ADMIN_PASSWORD_HASH=$2b$12$test.hash
    GOOGLE_APPLICATION_CREDENTIALS=/tmp/test-credentials.json