+++
id = "TASK-COMPOSE-20250429-003840"
title = "Add MongoDB Service to Docker Compose"
status = "üü¢ Done"
type = "üåü Feature"
priority = "‚ñ∂Ô∏è Medium"
created_date = "2025-04-29"
updated_date = "2025-04-29"
# due_date = ""
# estimated_effort = ""
assigned_to = "infra-compose"
# reporter = "roo-commander"
parent_task = "TASK-CMD-20250429-003830" # Commander's coordinating task
depends_on = []
related_docs = [".ruru/decisions/20250429-adopt-mongodb-primary-database.md"]
tags = ["docker", "docker-compose", "mongodb", "database", "infrastructure"]
template_schema_doc = ".ruru/templates/toml-md/01_mdtm_feature.README.md"
# ai_prompt_log = """"""
# review_checklist = []
# reviewed_by = ""
# key_learnings = ""
+++

# Add MongoDB Service to Docker Compose

## Description ‚úçÔ∏è

*   **What is this feature?** Add a MongoDB service definition to the main `docker-compose.yml` file.
*   **Why is it needed?** To provide a local MongoDB instance for development and testing, as decided in ADR-20250429-MONGO.
*   **Scope:** Modify `docker-compose.yml` to include the MongoDB service, necessary ports, volume for persistence, and basic environment variable setup for credentials.
*   **Links:** `.ruru/decisions/20250429-adopt-mongodb-primary-database.md`

## Acceptance Criteria ‚úÖ

*   - [‚úÖ] `docker-compose.yml` contains a new service named `mongodb`.
*   - [‚úÖ] The `mongodb` service uses a standard MongoDB image (e.g., `mongo:latest` or a specific recent version like `mongo:7`).
*   - [‚úÖ] The service exposes the standard MongoDB port (27017) to the Docker network (mapping to host is optional unless needed for direct access outside Docker).
*   - [‚úÖ] A Docker named volume (e.g., `mongo_data`) is defined in the top-level `volumes:` section.
*   - [‚úÖ] The `mongo_data` volume is mounted to `/data/db` inside the `mongodb` container for data persistence.
*   - [‚úÖ] Environment variables `MONGO_INITDB_ROOT_USERNAME` and `MONGO_INITDB_ROOT_PASSWORD` are defined within the `mongodb` service definition, referencing variables expected to be in an `.env` file (e.g., `${MONGO_INITDB_ROOT_USERNAME}`).
*   - [‚úÖ] Other services defined in `docker-compose.yml` (like `admin-api`) can resolve the `mongodb` service by its hostname `mongodb` on the Docker network.

## Implementation Notes / Sub-Tasks üìù

*   Ensure the chosen MongoDB image version is suitable.
*   Consider adding healthcheck configuration to the service definition.
*   [‚úÖ] Update `.env.dev.template` and `.env.prod.template` in `deploy/` to include placeholder variables for `MONGO_INITDB_ROOT_USERNAME` and `MONGO_INITDB_ROOT_PASSWORD`.

## Diagrams üìä (Optional)

*   N/A

## AI Prompt Log ü§ñ (Optional)

*   N/A

## Review Notes üëÄ (For Reviewer)

*   Verify volume mounting and environment variable usage.
*   Check network accessibility between services.

## Key Learnings üí° (Optional - Fill upon completion)

*